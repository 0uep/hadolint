#!/bin/bash

echo "=> Fetch unshallow origin"
git fetch --unshallow origin || true

echo "=> Tag image: 'scratch' (default)"
docker tag "${IMAGE_NAME}" "${DOCKER_REPO}:$(git describe --long --always)"

echo "=> Tag image: 'debian-slim'"
docker tag "${IMAGE_NAME}-debian-slim" "${DOCKER_REPO}:$(git describe --long --always)-debian-slim"

echo "=> Push images"
docker push "${DOCKER_REPO}"
